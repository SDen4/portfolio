(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{413:function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"admin__block-projects"},[t._m(0),o("div",{staticClass:"admin__data"},[o("div",{staticClass:"admin__edit-project",class:{"admin__edit-project_active":t.addNewWorkPoint}},[o("div",{staticClass:"admin__block_container admin__edit-project_container"},[!1===t.editWorkPoint?o("div",{staticClass:"admin__edit-project-subtitle"},[t._v("Добавление новой Работы")]):o("div",{staticClass:"admin__edit-project-subtitle"},[t._v("Редактирование Работы")]),o("div",{staticClass:"admin__edit-project-content"},[!1===t.editWorkPoint?o("form",{staticClass:"admin__edit-project-formdata",on:{submit:function(e){return e.preventDefault(),t.addNewWork(e)}}},[o("div",{staticClass:"admin__edit-project-content-left"},[o("label",{staticClass:"admin__edit-project-new-photo",class:{formPic:t.renderedPhotoProject.length},style:{backgroundImage:"url("+t.renderedPhotoProject+")"},attrs:{for:"add-work-photo"}},[o("span",{staticClass:"admin__edit-project-new-photo-text",class:{hideText:t.renderedPhotoProject.length}},[t._v("Перетащите или нажмите кноку для загрузки изображения")]),o("div",{staticClass:"button__add button__add_download button__add_download_label",class:{hideText:t.renderedPhotoProject.length}})]),o("input",{staticClass:"admin__new-review-add-photo-input",attrs:{id:"add-work-photo",accept:"image/*",type:"file"},on:{change:t.photoDownLoad}})]),o("div",{staticClass:"admin__edit-project-content-right"},[o("label",{staticClass:"admin__edit-project-data"},[o("div",{staticClass:"admin__edit-project-name"},[t._v("Название")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.work.title,expression:"work.title"}],staticClass:"admin__edit-project-input",attrs:{type:"text",placeholder:"Введите название нового проекта"},domProps:{value:t.work.title},on:{input:function(e){e.target.composing||t.$set(t.work,"title",e.target.value)}}}),o("div",{class:{"form__error_add-project":t.validation.hasError("work.title")}},[t._v(t._s(t.validation.firstError("work.title")))])]),o("label",{staticClass:"admin__edit-project-data"},[o("div",{staticClass:"admin__edit-project-name"},[t._v("Ссылка")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.work.link,expression:"work.link"}],staticClass:"admin__edit-project-input",attrs:{type:"text",placeholder:"Введите ссылку"},domProps:{value:t.work.link},on:{input:function(e){e.target.composing||t.$set(t.work,"link",e.target.value)}}}),o("div",{class:{"form__error_add-project":t.validation.hasError("work.link")}},[t._v(t._s(t.validation.firstError("work.link")))])]),o("label",{staticClass:"admin__edit-project-data admin__edit-project-data-textarea"},[o("div",{staticClass:"admin__edit-project-name"},[t._v("Описание")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.work.description,expression:"work.description"}],staticClass:"admin__edit-project-input admin__edit-project-input_textarea",attrs:{type:"text",placeholder:"Введите описание"},domProps:{value:t.work.description},on:{input:function(e){e.target.composing||t.$set(t.work,"description",e.target.value)}}}),o("div",{class:{"form__error_add-project_textarea":t.validation.hasError("work.description")}},[t._v(t._s(t.validation.firstError("work.description")))])]),o("label",{staticClass:"admin__edit-project-data"},[o("div",{staticClass:"admin__edit-project-name"},[t._v("Добавление тэга")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.work.techs,expression:"work.techs"}],staticClass:"admin__edit-project-input",attrs:{type:"text",placeholder:"Добавьте тэги через запятую"},domProps:{value:t.work.techs},on:{input:[function(e){e.target.composing||t.$set(t.work,"techs",e.target.value)},t.addTag]}}),o("div",{class:{"form__error_add-project":t.validation.hasError("work.techs")}},[t._v(t._s(t.validation.firstError("work.techs")))])]),o("ul",{staticClass:"admin__edit-project-tool-list"},t._l(t.work.techs,(function(e){return o("li",{key:e.id,staticClass:"projects__tools-item admin__edit-project-tool-item"},[o("div",{staticClass:"projects__tools-name projects__tools-name_admin"},[t._v(t._s(e))]),o("button",{staticClass:"projects__tools-close",attrs:{type:"button"},on:{click:function(o){return t.deleteTag(e)}}})])})),0),o("div",{staticClass:"admin__edit-project-form-buttons"},[o("button",{staticClass:"button__add button__add_cancel",attrs:{type:"reset"},on:{click:t.closeAddForm}}),o("button",{staticClass:"button__add button__add_submit",attrs:{type:"submit"}})])])]):o("form",{staticClass:"admin__edit-project-formdata"},[o("div",{staticClass:"admin__edit-project-content-left"},[o("label",{staticClass:"admin__edit-project-new-photo formPic",style:{backgroundImage:"url(https://webdev-api.loftschool.com/"+t.editedWork.photo+")"},attrs:{for:"add-work-photo"}},[o("span",{staticClass:"admin__edit-project-new-photo-text",class:{hideText:t.renderedPhotoProject.length}},[t._v("Изменение изображения")]),o("div",{staticClass:"button__add button__add_download button__add_download_label",class:{hideText:t.renderedPhotoProject.length}})]),o("input",{staticClass:"admin__new-review-add-photo-input",attrs:{id:"add-work-photo",accept:"image/*",type:"file"},on:{change:t.photoDownLoadEdited}})]),o("div",{staticClass:"admin__edit-project-content-right"},[o("label",{staticClass:"admin__edit-project-data"},[o("div",{staticClass:"admin__edit-project-name"},[t._v("Название")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.editedWork.title,expression:"editedWork.title"}],staticClass:"admin__edit-project-input",attrs:{type:"text",placeholder:"Введите название нового проекта"},domProps:{value:t.editedWork.title},on:{input:function(e){e.target.composing||t.$set(t.editedWork,"title",e.target.value)}}}),o("div",{class:{"form__error_add-project":t.validation.hasError("editedWork.title")}},[t._v(t._s(t.validation.firstError("editedWork.title")))])]),o("label",{staticClass:"admin__edit-project-data"},[o("div",{staticClass:"admin__edit-project-name"},[t._v("Ссылка")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.editedWork.link,expression:"editedWork.link"}],staticClass:"admin__edit-project-input",attrs:{type:"text",placeholder:"Введите ссылку"},domProps:{value:t.editedWork.link},on:{input:function(e){e.target.composing||t.$set(t.editedWork,"link",e.target.value)}}}),o("div",{class:{"form__error_add-project":t.validation.hasError("editedWork.link")}},[t._v(t._s(t.validation.firstError("editedWork.link")))])]),o("label",{staticClass:"admin__edit-project-data admin__edit-project-data-textarea"},[o("div",{staticClass:"admin__edit-project-name"},[t._v("Описание")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.editedWork.description,expression:"editedWork.description"}],staticClass:"admin__edit-project-input admin__edit-project-input_textarea",attrs:{type:"text",placeholder:"Введите описание"},domProps:{value:t.editedWork.description},on:{input:function(e){e.target.composing||t.$set(t.editedWork,"description",e.target.value)}}}),o("div",{class:{"form__error_add-project_textarea":t.validation.hasError("editedWork.description")}},[t._v(t._s(t.validation.firstError("editedWork.description")))])]),o("label",{staticClass:"admin__edit-project-data"},[o("div",{staticClass:"admin__edit-project-name"},[t._v("Добавление тэга")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.editedWork.techs,expression:"editedWork.techs"}],staticClass:"admin__edit-project-input",attrs:{type:"text",placeholder:"Добавьте тэг"},domProps:{value:t.editedWork.techs},on:{input:function(e){e.target.composing||t.$set(t.editedWork,"techs",e.target.value)}}}),o("div",{class:{"form__error_add-project":t.validation.hasError("editedWork.techs")}},[t._v(t._s(t.validation.firstError("editedWork.techs")))])]),o("ul",{staticClass:"admin__edit-project-tool-list"},t._l(t.editedWork.techs,(function(e){return o("li",{key:e.id,staticClass:"projects__tools-item admin__edit-project-tool-item"},[o("div",{staticClass:"projects__tools-name projects__tools-name_admin"},[t._v(t._s(e))]),o("button",{staticClass:"projects__tools-close",attrs:{type:"button"},on:{click:function(o){return t.deleteTag(e)}}})])})),0),o("div",{staticClass:"admin__edit-project-form-buttons"},[o("button",{staticClass:"button__add button__add_cancel",attrs:{type:"reset"},on:{click:t.closeAddForm}}),o("button",{staticClass:"button__add button__add_submit",attrs:{type:"submit"},on:{click:t.editWork}})])])])])])]),o("div",{staticClass:"admin__projects"},[o("ul",{staticClass:"admin__projects-list"},[o("li",{staticClass:"admin__projects-item_new"},[o("button",{staticClass:"admin__projects-add",on:{click:t.showAddForm}},[o("div",{staticClass:"admin__projects-add-button"}),o("div",{staticClass:"admin__projects-add-text"},[t._v("Добавить работу")])])]),t._l(t.works,(function(e){return o("li",{key:e.id,staticClass:"admin__projects-item"},[o("div",{staticClass:"admin__projects-preview"},[o("div",{staticClass:"admin__projects-preview_pic"},[o("img",{staticClass:"admin__projects-preview_pic",attrs:{src:"https://webdev-api.loftschool.com/"+e.photo,alt:"Project preview"}})]),o("ul",{staticClass:"admin__edit-project-tool-list admin__edit-project-tool-list_preview"},t._l(e.techs,(function(e){return o("li",{staticClass:"projects__tools-item admin__projects_tool"},[o("div",{staticClass:"projects__tools-name admin__projects__tool-name"},[t._v(t._s(e))])])})),0)]),o("div",{staticClass:"admin__projects-descr"},[o("div",{staticClass:"admin__projects-descr_container"},[o("div",{staticClass:"admin__projects-title"},[t._v(t._s(e.title))]),o("div",{staticClass:"admin__projects-text"},[t._v(t._s(e.description))]),o("a",{staticClass:"admin__projects-link",attrs:{href:""+e.link}},[t._v(t._s(e.link))]),o("div",{staticClass:"admin__projects-buttons"},[o("button",{staticClass:"button_edit button_edit_projects",attrs:{type:"button"},on:{click:function(o){return t.editWorkOpenForm(e)}}},[t._v("Править")]),o("button",{staticClass:"button__group button__group_remove button__group_remove_projects",attrs:{type:"button"},on:{click:function(o){return t.removeExistedWork(e)}}},[t._v("Удалить")])])])])])}))],2)])])])};i._withStripped=!0;var r=o(360),a=o(65);function s(t,e,o,i,r,a,s){try{var n=t[a](s),d=n.value}catch(t){return void o(t)}n.done?e(d):Promise.resolve(d).then(i,r)}function n(t){return function(){var e=this,o=arguments;return new Promise((function(i,r){var a=t.apply(e,o);function n(t){s(a,i,r,n,d,"next",t)}function d(t){s(a,i,r,n,d,"throw",t)}n(void 0)}))}}var d="https://webdev-api.loftschool.com",c={data:function(){return{renderedPhotoProject:"",addNewWorkPoint:!1,editWorkPoint:!1,works:[],work:{photo:{},title:"",link:"",description:"",techs:[]},editedWork:{}}},mixins:[o(65).mixin],validators:{"work.title":function(t){return a.Validator.value(t).required("Заполните поле")},"work.link":function(t){return a.Validator.value(t).required("Заполните поле")},"work.description":function(t){return a.Validator.value(t).required("Заполните поле")},"work.techs":function(t){return a.Validator.value(t).required("Заполните поле")}},created:function(t){this.fetchWorks()},methods:{addTag:function(t){var e=t.target.value.split(",");this.work.techs=e},deleteTag:function(t){console.log(t),this.work.techs=this.work.techs.filter((function(e){return e!==t}))},showAddForm:function(){this.addNewWorkPoint=!0},closeAddForm:function(){this.work.title="",this.work.link="",this.work.description="",this.work.techs=[],this.renderedPhotoProject="",this.work.photo={},this.validation.reset(),this.addNewWorkPoint=!1,this.editWorkPoint=!1},photoDownLoad:function(t){var e=this;return n(regeneratorRuntime.mark((function o(){var i;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:i=t.target.files[0],e.work.photo=i,e.renderImageFile(i);case 3:case"end":return o.stop()}}),o)})))()},photoDownLoadEdited:function(t){var e=this;return n(regeneratorRuntime.mark((function o(){var i;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:e.editedWork.photo="",i=t.target.files[0],e.editedWork.photo=i,e.renderImageFile(i);case 4:case"end":return o.stop()}}),o)})))()},renderImageFile:function(t){var e=this,o=new FileReader;try{o.readAsDataURL(t),o.onloadend=function(){e.renderedPhotoProject=o.result}}catch(t){throw new Error("Ошибка при чтении файла")}},addNewWork:function(){var t=this;this.$validate().then((function(e){if(e)try{var o=new FormData;Object.keys(t.work).forEach((function(e){var i=t.work[e];o.append(e,i)})),r.a.post(d+"/works",o).then((function(t){console.log(t.data),console.log("Проект добавлен")})),t.renderedPhotoProject="",t.work.photo={},t.work.title="",t.work.link="",t.work.description="",t.work.techs=[],t.validation.reset(),t.addNewWorkPoint=!1}catch(t){}}))},fetchWorks:function(){var t=this;return n(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.a.get(d+"/works/255");case 3:o=e.sent,t.works=o.data,console.log(t.works),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})))()},editWorkOpenForm:function(t){this.addNewWorkPoint=!0,this.editWorkPoint=!0,this.editedWork=t},editWork:function(){var t=this;return n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.a.post(d+"/works/".concat(t.editedWork.id),t.editedWork);case 3:e.sent,t.works=t.works.map((function(e){return e.id===t.editedWork.id?editedWork:e})),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:return e.prev=9,t.editWorkPoint=!1,t.addNewWorkPoint=!1,e.finish(9);case 13:case"end":return e.stop()}}),e,null,[[0,7,9,13]])})))()},removeExistedWork:function(t){var e=this;return n(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,r.a.delete(d+"/works/".concat(t.id));case 3:o.sent,e.works=e.works.filter((function(e){return e.id!==t.id})),o.next=9;break;case 7:o.prev=7,o.t0=o.catch(0);case 9:case"end":return o.stop()}}),o,null,[[0,7]])})))()}}},l=o(97),_=Object(l.a)(c,i,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"admin__title"},[e("h2",{staticClass:"admin__title-name admin__title-name_projects"},[this._v('Блок "Работы"')])])}],!1,null,null,null);_.options.__file="src/admin/components/pages/projects.vue";e.default=_.exports}}]);